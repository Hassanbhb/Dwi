extends layouts/layout.pug
block content
  include partials/navbar.pug
  main
    .postForm
      if errors
        each error in errors 
          p= error
      if successes
        each success in successes
          p= success
      form(action="dashboard/new/post", method="post")
        label Create Post
        textarea(name="newPost", placeHolder="What's on your mind?", required )
        button(type="submit") 
          img(src="images/sendIcon.svg", alt="Send")
    .posts
      //- reverse posts to display newest at the top
      each post in posts.reverse()
        .card
          .postOwner
            h3= `${post.author.name} ${post.author.lastName}`
            p= post.createdAt
          .postText
            p= post.body
          .postLikes
            img(src="images/heartIcon.svg", alt="heart")
            p.heart #{post.likes.length}
          .reaction
            button.likeBtn(data-postId= post._id) like
          .comments
            //- reverse comment array to display newest at the top
            each comment in post.comments.reverse()
              .comment
                .commentOwner
                  h5=`${comment.author.name} ${comment.author.lastName}`
                  p=comment.createdAt
                .commentText
                  p=comment.text
          form(action="dashboard/new/comment?_method=PUT", method="post")
            input(type="hidden", name="postId" value=post._id)
            input(type="text" name="comment" placeholder="Write a comment...")    
            button(type="submit") 
              img(src="images/sendIcon.svg", alt="Send")
block scripts
  script(src="/javascripts/likes.js")